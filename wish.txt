import 'dart:async';
import 'dart:math';

import 'package:flutter/material.dart';
import 'package:flutter_custom_clippers/flutter_custom_clippers.dart';
import 'secondscreen.dart';
import 'package:confetti/confetti.dart';

// import 'package:flutter_icons/flutter_icons.dart';
class Birthdaywishes extends StatefulWidget {
  @override
  _BirthdaywishesState createState() => _BirthdaywishesState();
}

class _BirthdaywishesState extends State<Birthdaywishes> {
  late ConfettiController _controllerCenterRight;
  late ConfettiController _controllerCenterLeft;
  late Timer _timer;
  late int _start = 5;

  var _state;
  void startTimer() {
    const oneSec = Duration(seconds: 3);
    _timer = Timer.periodic(
        oneSec,
        (Timer timer) => setState(() {
              if (_start < 1) {
                _controllerCenterRight.play();
                _controllerCenterLeft.play();
                timer.cancel();
              } else {
                _start = _start - 1;
              }
            }));
  }

  @override
  void initState() {
    _controllerCenterRight =
        ConfettiController(duration: const Duration(seconds: 10));
    _controllerCenterLeft =
        ConfettiController(duration: const Duration(seconds: 10));

    super.initState();
  }

  @override
  void dispose() {
    _timer.cancel();
    _controllerCenterLeft.dispose();
    _controllerCenterRight.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    startTimer();
    return Scaffold(
      bottomNavigationBar: Container(
        height: 20,
        child: const BottomAppBar(
          shape: CircularNotchedRectangle(),
          color: Colors.pinkAccent,
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          Navigator.push(
              context,
              MaterialPageRoute(
                builder: (context) => Nextscreen(),
              ));
        },
        child: const Icon(
          Icons.play_circle_fill_outlined,
          color: Colors.white,
          size: 50,
        ),
        backgroundColor: Colors.blue[900],
      ),
      floatingActionButtonLocation:
          FloatingActionButtonLocation.miniCenterDocked,
      body: Column(
        children: [
          ClipPath(
            clipper: WaveClipperTwo(),
            child: Container(
              height: 200,
              decoration: const BoxDecoration(
                  image: DecorationImage(
                      image: NetworkImage(
                          'https://st.depositphotos.com/1017986/2913/i/600/depositphotos_29133839-stock-photo-group-of-girls-chilling-on.jpg'),
                      fit: BoxFit.fill)),
            ),
          ),
          const Padding(
            padding: EdgeInsets.only(right: 15),
            child: Align(
              alignment: Alignment.topCenter,
              child: Text(
                "0",
                style: TextStyle(
                  fontWeight: FontWeight.w200,
                  fontSize: 50,
                ),
              ),
            ),
          ),
          Stack(
            children: [
              Align(
                alignment: Alignment.centerRight,
                child: ConfettiWidget(
                  confettiController: _controllerCenterRight,
                  blastDirection: pi,
                  particleDrag: 0.05,
                  emissionFrequency: 0.05,
                  numberOfParticles: 20,
                  gravity: 0.05,
                  shouldLoop: false,
                  colors: const [Colors.green, Colors.blue, Colors.pink],
                ),
              ),
              Align(
                alignment: Alignment.centerLeft,
                child: ConfettiWidget(
                  confettiController: _controllerCenterLeft,
                  blastDirection: 0,
                  emissionFrequency: 0.05,
                  minimumSize: const Size(10, 10),
                  maximumSize: const Size(10, 10),
                  numberOfParticles: 1,
                  gravity: 0.1,
                ),
              ),
              Column(children: const [
                Padding(padding: EdgeInsets.only(top: 5,left: 20),
                child:Center(child: Text("Happy",style: TextStyle(fontWeight: FontWeight.w900,color: Colors.indigo,fontSize: 90),)),),
                SizedBox(height: 2),
                 Padding(padding: EdgeInsets.only(left: 20),
                child:Center(child: Text("Birthday",style: TextStyle(fontWeight: FontWeight.w900,color: Colors.indigo,fontSize: 90),)),),
              ],)
            ],
          )
        ],
      ),
    );
  }
}

@override
Widget build(BuildContext context) {
  // TODO: implement build
  throw UnimplementedError();
}
